2025-06-26 17:55:30,050 - data_ingestion - INFO - Starting complete data ingestion process...
2025-06-26 17:55:30,051 - data_ingestion - INFO - Step 1: Ingesting states...
2025-06-26 17:55:30,051 - states_ingestion - INFO - Downloading states data from https://eric.clst.org/assets/wiki/uploads/Stuff/gz_2010_us_040_00_5m.json...
2025-06-26 17:55:31,391 - states_ingestion - INFO - States data saved to data/raw_geo/us_states_all.geojson
2025-06-26 17:55:31,391 - states_ingestion - INFO - Loading states data from data/raw_geo/us_states_all.geojson...
2025-06-26 17:55:32,733 - states_ingestion - ERROR - Failed to ingest states: (psycopg2.errors.ForeignKeyViolation) update or delete on table "states" violates foreign key constraint "counties_state_id_fkey" on table "counties"
DETAIL:  Key (id)=(165a1365-298d-473d-a896-db850f62488f) is still referenced from table "counties".

[SQL: DELETE FROM states]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-26 17:55:32,733 - data_ingestion - ERROR - Failed to ingest states. Exiting.
2025-06-26 17:56:46,207 - data_ingestion - INFO - Starting complete data ingestion process...
2025-06-26 17:56:46,207 - data_ingestion - INFO - Step 1: Clearing existing data...
2025-06-26 17:56:47,328 - data_ingestion - INFO - Clearing counties table...
2025-06-26 17:56:47,514 - data_ingestion - INFO - Clearing states table...
2025-06-26 17:56:47,716 - data_ingestion - INFO - All geographic data cleared successfully.
2025-06-26 17:56:47,716 - data_ingestion - INFO - Step 2: Ingesting states...
2025-06-26 17:56:47,716 - states_ingestion - INFO - Loading states data from data/raw_geo/us_states_all.geojson...
2025-06-26 17:56:49,073 - states_ingestion - INFO - Inserted state: Alabama (AL), FIPS: 01
2025-06-26 17:56:49,520 - states_ingestion - INFO - Inserted state: Alaska (AK), FIPS: 02
2025-06-26 17:56:49,830 - states_ingestion - INFO - Inserted state: Arizona (AZ), FIPS: 04
2025-06-26 17:56:50,036 - states_ingestion - INFO - Inserted state: Arkansas (AR), FIPS: 05
2025-06-26 17:56:50,256 - states_ingestion - INFO - Inserted state: California (CA), FIPS: 06
2025-06-26 17:56:50,465 - states_ingestion - INFO - Inserted state: Colorado (CO), FIPS: 08
2025-06-26 17:56:50,665 - states_ingestion - INFO - Inserted state: Connecticut (CT), FIPS: 09
2025-06-26 17:56:50,859 - states_ingestion - INFO - Inserted state: Delaware (DE), FIPS: 10
2025-06-26 17:56:51,053 - states_ingestion - INFO - Inserted state: District of Columbia (DC), FIPS: 11
2025-06-26 17:56:51,266 - states_ingestion - INFO - Inserted state: Florida (FL), FIPS: 12
2025-06-26 17:56:51,483 - states_ingestion - INFO - Inserted state: Georgia (GA), FIPS: 13
2025-06-26 17:56:51,674 - states_ingestion - INFO - Inserted state: Hawaii (HI), FIPS: 15
2025-06-26 17:56:51,882 - states_ingestion - INFO - Inserted state: Idaho (ID), FIPS: 16
2025-06-26 17:56:52,086 - states_ingestion - INFO - Inserted state: Illinois (IL), FIPS: 17
2025-06-26 17:56:52,290 - states_ingestion - INFO - Inserted state: Indiana (IN), FIPS: 18
2025-06-26 17:56:52,511 - states_ingestion - INFO - Inserted state: Iowa (IA), FIPS: 19
2025-06-26 17:56:52,723 - states_ingestion - INFO - Inserted state: Kansas (KS), FIPS: 20
2025-06-26 17:56:52,941 - states_ingestion - INFO - Inserted state: Kentucky (KY), FIPS: 21
2025-06-26 17:56:53,159 - states_ingestion - INFO - Inserted state: Louisiana (LA), FIPS: 22
2025-06-26 17:56:53,378 - states_ingestion - INFO - Inserted state: Maine (ME), FIPS: 23
2025-06-26 17:56:53,596 - states_ingestion - INFO - Inserted state: Maryland (MD), FIPS: 24
2025-06-26 17:56:53,796 - states_ingestion - INFO - Inserted state: Massachusetts (MA), FIPS: 25
2025-06-26 17:56:54,041 - states_ingestion - INFO - Inserted state: Michigan (MI), FIPS: 26
2025-06-26 17:56:54,270 - states_ingestion - INFO - Inserted state: Minnesota (MN), FIPS: 27
2025-06-26 17:56:54,477 - states_ingestion - INFO - Inserted state: Mississippi (MS), FIPS: 28
2025-06-26 17:56:54,701 - states_ingestion - INFO - Inserted state: Missouri (MO), FIPS: 29
2025-06-26 17:56:54,894 - states_ingestion - INFO - Inserted state: Montana (MT), FIPS: 30
2025-06-26 17:56:55,187 - states_ingestion - INFO - Inserted state: Nebraska (NE), FIPS: 31
2025-06-26 17:56:55,389 - states_ingestion - INFO - Inserted state: Nevada (NV), FIPS: 32
2025-06-26 17:56:55,592 - states_ingestion - INFO - Inserted state: New Hampshire (NH), FIPS: 33
2025-06-26 17:56:55,794 - states_ingestion - INFO - Inserted state: New Jersey (NJ), FIPS: 34
2025-06-26 17:56:55,994 - states_ingestion - INFO - Inserted state: New Mexico (NM), FIPS: 35
2025-06-26 17:56:56,215 - states_ingestion - INFO - Inserted state: New York (NY), FIPS: 36
2025-06-26 17:56:56,449 - states_ingestion - INFO - Inserted state: North Carolina (NC), FIPS: 37
2025-06-26 17:56:56,685 - states_ingestion - INFO - Inserted state: North Dakota (ND), FIPS: 38
2025-06-26 17:56:56,913 - states_ingestion - INFO - Inserted state: Ohio (OH), FIPS: 39
2025-06-26 17:56:57,165 - states_ingestion - INFO - Inserted state: Oklahoma (OK), FIPS: 40
2025-06-26 17:56:57,364 - states_ingestion - INFO - Inserted state: Oregon (OR), FIPS: 41
2025-06-26 17:56:57,566 - states_ingestion - INFO - Inserted state: Pennsylvania (PA), FIPS: 42
2025-06-26 17:56:57,760 - states_ingestion - INFO - Inserted state: Rhode Island (RI), FIPS: 44
2025-06-26 17:56:57,974 - states_ingestion - INFO - Inserted state: South Carolina (SC), FIPS: 45
2025-06-26 17:56:58,201 - states_ingestion - INFO - Inserted state: South Dakota (SD), FIPS: 46
2025-06-26 17:56:58,433 - states_ingestion - INFO - Inserted state: Tennessee (TN), FIPS: 47
2025-06-26 17:56:58,672 - states_ingestion - INFO - Inserted state: Texas (TX), FIPS: 48
2025-06-26 17:56:58,909 - states_ingestion - INFO - Inserted state: Utah (UT), FIPS: 49
2025-06-26 17:56:59,107 - states_ingestion - INFO - Inserted state: Vermont (VT), FIPS: 50
2025-06-26 17:56:59,330 - states_ingestion - INFO - Inserted state: Virginia (VA), FIPS: 51
2025-06-26 17:56:59,542 - states_ingestion - INFO - Inserted state: Washington (WA), FIPS: 53
2025-06-26 17:56:59,814 - states_ingestion - INFO - Inserted state: West Virginia (WV), FIPS: 54
2025-06-26 17:57:00,060 - states_ingestion - INFO - Inserted state: Wisconsin (WI), FIPS: 55
2025-06-26 17:57:00,280 - states_ingestion - INFO - Inserted state: Wyoming (WY), FIPS: 56
2025-06-26 17:57:00,479 - states_ingestion - INFO - Inserted state: Puerto Rico (PR), FIPS: 72
2025-06-26 17:57:00,480 - states_ingestion - INFO - Successfully inserted 52 states.
2025-06-26 17:57:00,480 - states_ingestion - INFO - Skipped 0 states.
2025-06-26 17:57:00,488 - data_ingestion - INFO - Step 3: Ingesting counties...
2025-06-26 17:57:00,488 - counties_ingestion - INFO - Downloading counties data from https://eric.clst.org/assets/wiki/uploads/Stuff/gz_2010_us_050_00_5m.json...
2025-06-26 17:57:01,902 - counties_ingestion - INFO - Counties data saved to data/raw_geo/us_counties_all.geojson
2025-06-26 17:57:01,903 - counties_ingestion - INFO - Loading counties data from data/raw_geo/us_counties_all.geojson...
2025-06-26 17:57:03,204 - counties_ingestion - INFO - Found 52 states in the database.
2025-06-26 17:57:21,733 - counties_ingestion - INFO - Inserted 100 counties so far...
2025-06-26 17:57:40,469 - counties_ingestion - INFO - Inserted 200 counties so far...
2025-06-26 17:57:58,593 - counties_ingestion - INFO - Inserted 300 counties so far...
2025-06-26 17:58:16,839 - counties_ingestion - INFO - Inserted 400 counties so far...
2025-06-26 17:58:34,936 - counties_ingestion - INFO - Inserted 500 counties so far...
2025-06-26 17:58:53,197 - counties_ingestion - INFO - Inserted 600 counties so far...
2025-06-26 17:59:11,492 - counties_ingestion - INFO - Inserted 700 counties so far...
2025-06-26 17:59:29,481 - counties_ingestion - INFO - Inserted 800 counties so far...
2025-06-26 17:59:47,723 - counties_ingestion - INFO - Inserted 900 counties so far...
2025-06-26 18:00:06,499 - counties_ingestion - INFO - Inserted 1000 counties so far...
2025-06-26 18:00:24,956 - counties_ingestion - INFO - Inserted 1100 counties so far...
2025-06-26 18:00:43,227 - counties_ingestion - INFO - Inserted 1200 counties so far...
2025-06-26 18:01:02,504 - counties_ingestion - INFO - Inserted 1300 counties so far...
2025-06-26 18:01:21,470 - counties_ingestion - INFO - Inserted 1400 counties so far...
2025-06-26 18:01:39,750 - counties_ingestion - INFO - Inserted 1500 counties so far...
2025-06-26 18:01:58,507 - counties_ingestion - INFO - Inserted 1600 counties so far...
2025-06-26 18:02:17,073 - counties_ingestion - INFO - Inserted 1700 counties so far...
2025-06-26 18:02:35,230 - counties_ingestion - INFO - Inserted 1800 counties so far...
2025-06-26 18:02:53,785 - counties_ingestion - INFO - Inserted 1900 counties so far...
2025-06-26 18:03:12,380 - counties_ingestion - INFO - Inserted 2000 counties so far...
2025-06-26 18:03:34,883 - counties_ingestion - INFO - Inserted 2100 counties so far...
2025-06-26 18:03:56,560 - counties_ingestion - INFO - Inserted 2200 counties so far...
2025-06-26 18:04:18,208 - counties_ingestion - INFO - Inserted 2300 counties so far...
2025-06-26 18:04:36,729 - counties_ingestion - INFO - Inserted 2400 counties so far...
2025-06-26 18:04:55,523 - counties_ingestion - INFO - Inserted 2500 counties so far...
2025-06-26 18:05:13,775 - counties_ingestion - INFO - Inserted 2600 counties so far...
2025-06-26 18:05:32,127 - counties_ingestion - INFO - Inserted 2700 counties so far...
2025-06-26 18:05:50,271 - counties_ingestion - INFO - Inserted 2800 counties so far...
2025-06-26 18:06:08,804 - counties_ingestion - INFO - Inserted 2900 counties so far...
2025-06-26 18:06:27,189 - counties_ingestion - INFO - Inserted 3000 counties so far...
2025-06-26 18:06:45,604 - counties_ingestion - INFO - Inserted 3100 counties so far...
2025-06-26 18:07:03,783 - counties_ingestion - INFO - Inserted 3200 counties so far...
2025-06-26 18:07:10,016 - counties_ingestion - INFO - Successfully inserted 3221 counties.
2025-06-26 18:07:10,016 - counties_ingestion - INFO - Skipped 0 counties.
2025-06-26 18:07:10,036 - data_ingestion - INFO - Step 4: Creating spatial indexes...
2025-06-26 18:07:11,230 - spatial_indexes - INFO - Creating spatial index on states.geometry...
2025-06-26 18:07:11,365 - spatial_indexes - INFO - Creating spatial index on states.centroid...
2025-06-26 18:07:11,432 - spatial_indexes - INFO - Creating spatial index on counties.geometry...
2025-06-26 18:07:11,501 - spatial_indexes - INFO - Creating spatial index on counties.centroid...
2025-06-26 18:07:11,569 - spatial_indexes - INFO - Creating index on counties.state_id...
2025-06-26 18:07:11,641 - spatial_indexes - INFO - Creating index on counties.fips_code...
2025-06-26 18:07:11,717 - spatial_indexes - INFO - Creating index on states.fips_code...
2025-06-26 18:07:11,785 - spatial_indexes - INFO - All spatial indexes created successfully!
2025-06-26 18:07:11,857 - data_ingestion - INFO - Complete data ingestion process finished successfully!
